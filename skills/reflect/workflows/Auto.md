# Auto Workflow

Lightweight session-end analysis that queues corrections for later review.

## Trigger
- Stop hook (session end)
- `/reflect auto`

## Purpose

Instead of interrupting the user at session end, this workflow:
1. Quickly scans for HIGH priority corrections only
2. Queues findings to `~/.claude/Scratchpad/reflect-queue.md`
3. Silent operation - no user interaction required

## Process

### Step 1: Quick Scan

Only look for explicit corrections (HIGH priority):
- "don't" / "never" / "wrong" / "stop"
- "use X instead" / "instead use"

Skip MEDIUM and LOW priority to keep it fast.

### Step 2: Extract Minimal Data

For each HIGH correction found:
```
TIMESTAMP: ISO datetime
SESSION_ID: Current session identifier (if available)
QUOTE: User's exact words (max 200 chars)
SUGGESTED: Brief rule (max 100 chars)
```

### Step 3: Queue to File

Append to `~/.claude/Scratchpad/reflect-queue.md`:

```markdown
## Pending from {TIMESTAMP}

- **"{QUOTE}"**
  - Suggested: {SUGGESTED}
  - Session: {SESSION_ID}
```

### Step 4: Silent Exit

No output to user. The CheckQueue hook will notify them on next session start.

## Queue File Format

```markdown
# Reflect Queue
<!-- Auto-generated by /reflect auto workflow -->

## Pending from 2026-01-05T14:30:00

- **"Don't use npm, use bun"**
  - Suggested: Use bun instead of npm for package management
  - Session: abc123

- **"Never use inline styles"**
  - Suggested: Use Tailwind utility classes instead of inline CSS
  - Session: abc123

## Pending from 2026-01-04T09:15:00

- **"Wrong - use TypeScript strict mode"**
  - Suggested: Always enable strict mode in tsconfig.json
  - Session: def456
```

## Error Handling

| Situation | Action |
|-----------|--------|
| No corrections found | Exit silently (no queue entry) |
| Queue file doesn't exist | Create it with header |
| Write error | Log to stderr, don't fail session end |

## Integration with Process Workflow

After queuing, user runs `/reflect process` to:
1. Review all queued items
2. Select which to apply
3. Clear processed items from queue
