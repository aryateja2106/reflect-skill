# Review Workflow

Interactive review for selecting and scoping learnings.

## Trigger
- Automatically after Analyze workflow

## Input
- List of detected corrections from Analyze

## Process

### Step 1: Display Selection UI

For each learning, show:

```
SELECT LEARNINGS TO APPLY

[x] 1. [HIGH] Never use inline CSS
    Type: CONSTRAINT

[x] 2. [HIGH] Use bun instead of npm
    Type: PATTERN

[ ] 3. [MED] Prefer Flexbox over Grid
    Type: PREFERENCE (skipped - too specific?)

Enter numbers to toggle, or 'all' / 'none' / 'done'
```

### Step 2: Scope Selection

For each selected learning:

```
SCOPE: "Never use inline CSS"

Where should this apply?

[P] Project (Default) - Recommended
    Target: ./CLAUDE.md
    Affects: This project only

[G] Global
    Target: ~/.claude/Skills/FrontendDesign/SKILL.md
    Affects: All projects using this skill
    Warning: Use only for truly universal rules

[S] Skip this learning
```

### Step 3: Target Detection

Run `tools/DetectTarget.sh` to find the right file:

```bash
# For Project scope
./tools/DetectTarget.sh project
# Returns: ./CLAUDE.md (or .cursorrules, etc.)

# For Global scope  
./tools/DetectTarget.sh global "FrontendDesign"
# Returns: ~/.claude/Skills/FrontendDesign/SKILL.md
```

### Step 4: Preview Changes

Show exactly what will be added and where:

```
PREVIEW: ./CLAUDE.md

Current file ends with:
---
45: - Use TypeScript strict mode
46: - Run tests before committing
47:
---

Will append:
---
+
+ ## Learnings
+ <!-- Generated by /reflect | 2026-01-05 -->
+
+ ### Constraints
+ - Never use inline CSS; use Tailwind utility classes
+
+ ### Patterns
+ - Use bun instead of npm for package management
---

[Apply] [Edit First] [Cancel]
```

### Step 5: Conflict Check

If target already has a Learnings section:

```
EXISTING LEARNINGS FOUND

File already has a Learnings section with:
- Never commit directly to main
- Always use conventional commits

New entries will be appended to existing section.

[Proceed] [View Full Section] [Cancel]
```

### Step 6: Output

Pass approved learnings to Apply workflow:

```
APPROVED_LEARNINGS:
- learning: "Never use inline CSS; use Tailwind utility classes"
  category: CONSTRAINT
  scope: PROJECT
  target: ./CLAUDE.md

- learning: "Use bun instead of npm for package management"
  category: PATTERN
  scope: PROJECT
  target: ./CLAUDE.md

SKIPPED:
- "Prefer Flexbox over Grid" (user declined)
```
